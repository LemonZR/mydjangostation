<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>charts for  {{ table.table_name }} </title>
</head>
<body>
<div>
    <form>
        {% csrf_token %}

        <ul>
            {% for table in tables %}
            <li class="table_name" style="cursor:hand" >{{ table.table_name }}</li>

            {% endfor %}

        </ul>

    </form>
</div>
</body>
<script type="text/javascript" src="https://assets.pyecharts.org/assets/echarts.min.js"></script>
<script type="text/javascript">
        	    $('.table_name').click(function () {
        	    this_button = $(this)
                this_button.attr("disabled",true);
                var csrf =$("input[name='csrfmiddlewaretoken']").val()
                var table_name =this_button.text()
		        $.ajax({
				  url:  '/mycharts/drawtable/',
				  type: 'POST',
				  async: false,
				  traditional:true,
				  headers:{'X-CSRFtoken':csrf},
				  data: JSON.stringify({'table_name':table_name}),
				  processData: false,// 告诉jQuery不要去处理发送的数据
				  contentType: false,// 告诉jQuery不要去设置Content-Type请求头
				  beforeSend: function() {//过程...

				  },
				  complete : function ()
				  {

				  },
				  success: function (res) {

                          $("#drawing").html(res);

				   },
				   error:function(){
				   		console.log('404')
				   }
				})

			   setTimeout(function(){
                this_button.attr("disabled",false);
                }, 1000);

			})

</script>

</html>